<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.awethumb.repository.dao.AlarmDAO">

<insert id="insertAlarm" parameterType="Alarm">
	INSERT INTO alarm_tb(
		receive_user_no, 
		send_user_no, 
		alarm_type
		<if test="boardNo != null">
            , board_no
        </if>
		<if test="commentNo != null">
            , comment_no
        </if>
		<if test="projectNo != null">
            , project_no
        </if>
	)
	VALUES (
		#{receiveUserNo}, 
		#{sendUserNo}, 
		#{alarmType}
		<if test="boardNo != null">
            , #{boardNo}
        </if>
		<if test="commentNo != null">
            , #{commentNo}
        </if>
		<if test="projectNo != null">
            , #{projectNo}
        </if>
	)
</insert>

<select id="selectAlarmCnt" parameterType="int" resultType="int">
	select count(*)
	  from alarm_tb
	 where receive_user_no = #{userNo}
	   and alarm_check = 'N'
</select>

<select id="selectUserNoByBoardNo" parameterType="int" resultType="int">
	SELECT ut.user_no
      FROM user_tb ut, project_tb pt, board_tb bt
     WHERE ut.user_no = pt.user_no
       AND pt.project_no = bt.project_no
       AND bt.post_no = #{boardNo}
</select>
<select id="selectUserNoByCommentNo" parameterType="int" resultType="int">
	SELECT ut.user_no
      FROM user_tb ut, project_tb pt, board_tb bt, comment_tb ct
     WHERE ut.user_no = pt.user_no
       AND pt.project_no = bt.project_no
       AND bt.post_no = ct.post_no
       AND ct.cmt_no = #{commentNo}
</select>
<select id="selectUserNoListByProjectNo" parameterType="int" resultType="int">
	SELECT shared_user_no
      FROM shared_project_tb
     WHERE project_no = #{projectNo}
</select>

</mapper>




