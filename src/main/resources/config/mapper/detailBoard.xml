<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.awethumb.repository.dao.DetailBoardDAO">
	
	<select id="selectBoardList" resultType="Board">
		select *
		  from board_tb
	</select>
	
	<select id="selectImgList" parameterType="int" resultType="Board">
		select *
		  from board_file_tb
		 where post_no = ${postNo}
	</select>
	
	<insert id="insertBoard" parameterType="Board">
		insert into board_tb (
			project_no, post_content, x_coord, y_coord, width, hight
		) values (
			${projectNo}, '${postContent}', 0, 0, 1, 1
		);
	</insert>
	
	<!-- 글 번호로 글쓴이의 정보 받아옴 -->
	<select id="selectWriter" parameterType="int" resultType="String">
		select user_id 
		from user_tb
		where user_no = (
			select user_no 
			from project_tb 
			where project_no = (
				select project_no 
				from board_tb 
				where post_no = ${postNo}
			)
		);
	</select>
	
	<delete id="deleteBoard" parameterType="int">
		delete 
		from board_tb
		where post_no = ${postNo}
	</delete>
	
	<select id="selectOneBoard" parameterType="int" resultType="Board">
		select *
		from board_tb
		where post_no = ${postNo}
	</select>
	
	<update id="updateBoard" parameterType="Board">
		update board_tb
		set post_content = '${postContent}'
		where post_no = ${postNo}
	</update>
	
	<update id="updateList" parameterType="Board">
		update board_tb
		set
			x_coord = ${xCoord}, 
			y_coord = ${yCoord}, 
			width = ${width}, 
			hight = ${hight}
		where post_no = ${postNo};
	</update>
	
	<insert id="insertImage" parameterType="BoardFile">
		insert into board_file_tb (
			board_file_sys_name, board_file_org_name, board_file_path, 
			board_file_size, board_file_exe, post_no
		) values (
			'${boardFileSysName}', '${boardFileOrgName}', '${boardFilePath}', 
			${boardFileSize}, '${boardFileExe}', ${postNo}
		);
	</insert>
	
	<select id="postNoSelect" resultType="int">
		select post_no 
		from board_tb 
		order by post_no 
		desc limit 1;
	</select>
	
	<select id="selectProjectName" resultType="Project" parameterType="int">
		select *
		from project_tb 
		where project_no = ${projectNo};
	</select>
	
	<update id="updateProjectName" parameterType="Project">
		update project_tb
		set project_title = '${projectTitle}'
		where project_no = ${projectNo}
	</update>
</mapper>




