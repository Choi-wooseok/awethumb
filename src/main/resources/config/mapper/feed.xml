<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.awethumb.repository.dao.FeedDAO">
	
	<select id="selectFeedBoard" resultType="FeedBoard">
		SELECT ut.user_nickname,
			   bt.post_no,
		       bt.post_content,
			   bt.view_cnt,
			   bt.project_no
		  FROM user_tb ut
		 INNER JOIN project_tb pt
		    ON ut.user_no = pt.user_no
		 INNER JOIN board_tb bt
		    ON pt.project_no = bt.project_no
	</select>
	
	<select id="selectFeedBoardComment" parameterType="int" resultType="Comment">
		select *
		  from comment_tb
		 where post_no = #{postNo}
		 order by cmt_reg_dt
	</select>
	
	<select id="selectOneComment" parameterType="int" resultType="Comment">
		select *
		  from comment_tb
		 where cmt_no = #{cmtNo} 
	</select>
	
	<select id="selectCommentNo" resultType="int">
		SELECT cmt_no
		  FROM comment_tb
	</select>
	
	<select id="selectCmtNo" parameterType="int" resultType="int">
		SELECT cmt_no
		  FROM comment_tb
		 WHERE post_no = #{postNo} 
	</select>
	
	<select id="commentTime" parameterType="int" resultType="int">
		SELECT TIMESTAMPDIFF(
				minute,
				 (select cmt_reg_dt
				    FROM comment_tb
				   WHERE cmt_no = ${cmtNo}),
				   NOW()
				);
	</select>
	
	
	<insert id="insertBoardComment" parameterType="Comment" >
		INSERT INTO comment_tb (
		cmt_content, user_no, post_no
		)values( 
		#{cmtContent}, #{userNo}, #{postNo}
		);
	</insert>
	
	<delete id="deleteBoardComment" parameterType="int">
		DELETE 
		  FROM comment_tb
		 WHERE cmt_no = #{cmtNo}
	</delete>
	
	<update id="updateBoardComment" parameterType="Comment">
		UPDATE comment_tb
		   SET cmt_content = #{cmtContent}
		 WHERE cmt_no = #{cmtNo}
	</update>

</mapper>




